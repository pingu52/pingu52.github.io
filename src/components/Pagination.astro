---
const { currentPage, totalPages, basePath = "/page" } = Astro.props as {
  currentPage: number;
  totalPages: number;
  basePath?: string;
};

function pageHref(page: number) {
  return page === 1 ? "/" : `${basePath}/${page}/`;
}

// A compact pagination like: 1 2 3 4 5 … last
const pagesToShow = 5;
const start = Math.max(1, currentPage - 2);
const end = Math.min(totalPages, start + pagesToShow - 1);
const visible = Array.from({ length: end - start + 1 }, (_, i) => start + i);
---

<nav class="pagination" aria-label="pagination">
  <a class={"icon " + (currentPage <= 1 ? "disabled" : "")} href={pageHref(currentPage - 1)} aria-label="이전 페이지">
    ◀
  </a>

  {visible.map((p) => (
    p === currentPage
      ? <span class="page selected">{p}</span>
      : <a class="page" href={pageHref(p)}>{p}</a>
  ))}

  {end < totalPages ? <span class="page disabled">…</span> : null}
  {end < totalPages ? <a class="page" href={pageHref(totalPages)}>{totalPages}</a> : null}

  <a class={"icon " + (currentPage >= totalPages ? "disabled" : "")} href={pageHref(currentPage + 1)} aria-label="다음 페이지">
    ▶
  </a>
</nav>
